{"version":3,"kind":"Notebook","sha256":"9c9035cb4106c222105c833423d2cd4bdb911af5f86e19ec44621cb74e9c17fd","slug":"n-2-1-esempi-interpolazione","location":"/capitolo2/n_2_1_esempi_interpolazione.ipynb","dependencies":[],"frontmatter":{"title":"Esempi di interpolazione - Notebook 2.1","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"n_2_1_esempi_interpolazione.ipynb","url":"/elab_bioimmagini-site/build/n_2_1_esempi_interpo-f7fd8f9b9767b3aa1bbf47d46e580b84.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import delle librerie necessarie per la simulazione","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kU4wcAMpON"}],"key":"TutNSvxT6x"}],"key":"CrYWoLNAsP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.ndimage as ndi\nfrom scipy.interpolate import interpn\nfrom scipy.spatial.distance import euclidean\nfrom scipy.ndimage import zoom\nimport pydicom\nimport os\nimport imageio\nimport napari","key":"XAQ1jNvmHQ"},{"type":"outputs","id":"lcQKt5jgf2oTK8mzt688x","children":[],"key":"psVC03ll60"}],"key":"R3bz5l5IE5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lettura file DICOM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"koYug7PWhZ"}],"identifier":"lettura-file-dicom","label":"Lettura file DICOM","html_id":"lettura-file-dicom","implicit":true,"key":"l65JeRAwot"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Import dei dati DICOM da cartella specifica e visualizzazione 3D del dataset tramite la libreria ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zMnAKNyCwk"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"napari","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Eap5LqW1bh"}],"key":"YyNP7is8IB"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xvrQUva4Qo"}],"key":"mZergFnfhs"}],"key":"sAySZn0IUX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# set directory\ndirectory = '../data/Phantom_CT_PET/2-CT 2.5mm-5.464/'\n\n# get all files in directory\nfiles = sorted(os.listdir(directory))\nprint(files)\n\n# get info from dicom\nds = pydicom.dcmread(directory + files[0])\nprint(\"Patient ID:\", ds.PatientID)\n\n# get size along 3 axis\nxSize = ds.Rows\nySize = ds.Columns\nzSize = len(files)\nprint(xSize, ySize, zSize)\n\n# get resolution\ndx = ds.PixelSpacing[0]\ndy = ds.PixelSpacing[1]\nloc1 = ds.ImagePositionPatient\nds2  = pydicom.dcmread(directory + files[1])\nloc2 = ds2.ImagePositionPatient\ndz = euclidean(loc1, loc2)\n\n# import volume\nvol = imageio.volread(directory, 'DICOM')\nFOV = [dx*xSize,dy*ySize,dz*zSize]\nprint(\"FOV:\", FOV)\n\n# check  size\nprint(\"dimensioni del dato:\", vol.shape)\n\n#use napari\nviewer = napari.view_image(vol, name = \"my volume\", colormap = \"gray\")\n\n#run the viewer\nnapari.run()","key":"dkujxM9rwT"},{"type":"outputs","id":"tvtipQXYZvS5OdhQBImGD","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"['000000.dcm', '000001.dcm', '000002.dcm', '000003.dcm', '000004.dcm', '000005.dcm', '000006.dcm', '000007.dcm', '000008.dcm', '000009.dcm', '000010.dcm', '000011.dcm', '000012.dcm', '000013.dcm', '000014.dcm', '000015.dcm', '000016.dcm', '000017.dcm', '000018.dcm', '000019.dcm', '000020.dcm', '000021.dcm', '000022.dcm', '000023.dcm', '000024.dcm', '000025.dcm', '000026.dcm', '000027.dcm', '000028.dcm', '000029.dcm', '000030.dcm', '000031.dcm', '000032.dcm', '000033.dcm', '000034.dcm', '000035.dcm', '000036.dcm', '000037.dcm', '000038.dcm', '000039.dcm', '000040.dcm', '000041.dcm', '000042.dcm', '000043.dcm', '000044.dcm', '000045.dcm', '000046.dcm', '000047.dcm', '000048.dcm', '000049.dcm', '000050.dcm', '000051.dcm', '000052.dcm', '000053.dcm', '000054.dcm', '000055.dcm', '000056.dcm', '000057.dcm', '000058.dcm', '000059.dcm', '000060.dcm', '000061.dcm', '000062.dcm']\nPatient ID: SNMCB04\n512 512 63\nReading DICOM (examining files): 1/63 files (1.6%63/63 files (100.0%)\n  Found 1 correct series.\nReading DICOM (loading data): 63/63  (100.0%)\nFOV: [350.000128, 350.000128, 157.5]\ndimensioni del dato: (63, 512, 512)\n"},"children":[],"key":"j8hiYpKuvm"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_3149/354224610.py:35: FutureWarning: `napari.view_image` is deprecated and will be removed in napari 0.7.0.\nUse `viewer = napari.Viewer(); viewer.add_image(...)` instead.\n  viewer = napari.view_image(vol, name = \"my volume\", colormap = \"gray\")\n"},"children":[],"key":"ZuPJwRNoUs"}],"key":"y181q33kHG"}],"key":"TkiXBYprEW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione tramite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"byGMEVpNCF"},{"type":"inlineCode","value":"interpn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ar0twIR6PC"}],"identifier":"interpolazione-tramite-interpn","label":"Interpolazione tramite interpn","html_id":"interpolazione-tramite-interpn","implicit":true,"key":"I64e7x2W8J"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Esempio di interpolazione tramite l’utilizzo della funzione ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WOYPAKYDvW"},{"type":"inlineCode","value":"interpn","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IZUbuCJHhA"},{"type":"text","value":" e visualizzazione 3D tramite la libreria ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bUN8LVODPA"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"napari","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LvGqfFicCg"}],"key":"rElAxL6TMy"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MmXfsmbo61"}],"key":"yDikUkua5J"}],"key":"FHOOhsL9Se"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# original coordinates\nx = np.arange(0,xSize*dx,dx)\ny = np.arange(0,ySize*dy,dy)\nz = np.arange(0,zSize*dz,dz)\n\n# new coordinates\nnew_x = np.arange(0,xSize*dx,dx)\nnew_y = np.arange(0,ySize*dy,dy)\nnew_z = np.arange(0,(zSize-1)*dz,dx)\n\n# mesh of new coordinates\nnew_coords = np.meshgrid(new_z,new_x, new_y, indexing = 'ij');\nvolumeInt = interpn((z,x,y), vol, np.stack(new_coords,axis=-1))\n\n# check new size\nprint(\"dimensioni dopo interpolazione:\", volumeInt.shape)\n\n# use napari\nviewer = napari.view_image(volumeInt, name = \"my volume interpolated\", colormap = \"gray\")\n\n# run the viewer\nnapari.run()","key":"zFJv5Ocxxu"},{"type":"outputs","id":"laLIsnLAjwADt53KWRuUm","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"dimensioni dopo interpolazione: (227, 512, 512)\n"},"children":[],"key":"VvKMoyAFGe"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_3149/298611104.py:19: FutureWarning: `napari.view_image` is deprecated and will be removed in napari 0.7.0.\nUse `viewer = napari.Viewer(); viewer.add_image(...)` instead.\n  viewer = napari.view_image(volumeInt, name = \"my volume interpolated\", colormap = \"gray\")\n"},"children":[],"key":"mxUMcRyjxo"}],"key":"fLiDuLoQlY"}],"key":"vjpHBw94y4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione tramite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cIQetxXgEN"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bdaExv2YtF"}],"identifier":"interpolazione-tramite-zoom","label":"Interpolazione tramite zoom","html_id":"interpolazione-tramite-zoom","implicit":true,"key":"hKguW2XCnQ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Interpolazione nel piano tramite l’utilizzo della funzione ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"G16bdPWefd"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qZfL6UC46g"}],"key":"T91aGEmky4"}],"key":"OY56ThSbmy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plane interpolation\nimg = vol[33,:,:]\n\n# original image\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Original\")\nplt.show()\n\n# set scaling factor\nscaling_factors = (2, 2)","key":"rUY4hQSWir"},{"type":"outputs","id":"UDXCR7AMj2A3YdvdXXAf1","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a7f4a104f64900a5343bc6e5915fb76c","path":"/elab_bioimmagini-site/build/a7f4a104f64900a5343bc6e5915fb76c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"skMfohKTie"}],"key":"A8XlQFUPR8"}],"key":"Oxo6RHrvfX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione NN","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L8tSYKWjHs"}],"identifier":"interpolazione-nn","label":"Interpolazione NN","html_id":"interpolazione-nn","implicit":true,"key":"oclAGrs6sf"}],"key":"sjX6HCuKXS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# nearest neighbor\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 0)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"NN\")\nplt.show()","key":"ECMS9WswpI"},{"type":"outputs","id":"3S3O9mDE3_ZVwrjDlsPgW","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ef409af3b6fddacfe8c46edb09222a39","path":"/elab_bioimmagini-site/build/ef409af3b6fddacfe8c46edb09222a39.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"x3Ysu7WoXK"}],"key":"S8VLQu9VoJ"}],"key":"kJYAikLerA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione bilineare","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sDfcdAOjMU"}],"identifier":"interpolazione-bilineare","label":"Interpolazione bilineare","html_id":"interpolazione-bilineare","implicit":true,"key":"fvwnchp8LZ"}],"key":"khgMq8tkSJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# bilinear\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 1)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Bilinear\")\nplt.show()\n","key":"naPJw9Tbwv"},{"type":"outputs","id":"bTHpKwB4JGDbxKJB61aHi","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d4f20cff853f4b59148f2922fee2c269","path":"/elab_bioimmagini-site/build/d4f20cff853f4b59148f2922fee2c269.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"tK66mN8JNX"}],"key":"xTWkRSdZzK"}],"key":"zrJkS9JNIL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione bicubica","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rX1EJ0hCvp"}],"identifier":"interpolazione-bicubica","label":"Interpolazione bicubica","html_id":"interpolazione-bicubica","implicit":true,"key":"DpgxtHOnFe"}],"key":"pDUKemq2Do"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# bicubic\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 3)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Bicubic\")\nplt.show()\n","key":"aQQcyHlJDk"},{"type":"outputs","id":"7SnJ-FI5-Qdaa-sI9eg0e","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f165ce5eba3b7c72a9404294b26bbc8b","path":"/elab_bioimmagini-site/build/f165ce5eba3b7c72a9404294b26bbc8b.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"EnfM0EIQSK"}],"key":"EevOFfRgzx"}],"key":"gzpyKZdH5K"}],"key":"S9dpwBAKyI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Capitolo 2: Interpolazione, filtraggio e compressione","url":"/c21-interpolazione-filtraggio-e-compressione-compl","group":"Capitolo2"},"next":{"title":"Esempi di filtraggio - Notebook 2.2","url":"/n-2-2-esempi-filtraggio","group":"Capitolo2"}}},"domain":"http://localhost:3000"}