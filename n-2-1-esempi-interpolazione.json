{"version":3,"kind":"Notebook","sha256":"9c9035cb4106c222105c833423d2cd4bdb911af5f86e19ec44621cb74e9c17fd","slug":"n-2-1-esempi-interpolazione","location":"/capitolo2/n_2_1_esempi_interpolazione.ipynb","dependencies":[],"frontmatter":{"title":"Esempi di interpolazione - Notebook 2.1","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"n_2_1_esempi_interpolazione.ipynb","url":"/elab_bioimmagini-site/build/n_2_1_esempi_interpo-f7fd8f9b9767b3aa1bbf47d46e580b84.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import delle librerie necessarie per la simulazione","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jMfXp62KPD"}],"key":"pKCn9CCifk"}],"key":"SieSDYc76B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.ndimage as ndi\nfrom scipy.interpolate import interpn\nfrom scipy.spatial.distance import euclidean\nfrom scipy.ndimage import zoom\nimport pydicom\nimport os\nimport imageio\nimport napari","key":"JY3S91zOQ2"},{"type":"outputs","id":"MPZLQTVLfx3R3b8b4HvJu","children":[],"key":"HSxk8IFPon"}],"key":"ECD6BRVmjY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lettura file DICOM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLMRoHfEX9"}],"identifier":"lettura-file-dicom","label":"Lettura file DICOM","html_id":"lettura-file-dicom","implicit":true,"key":"cx2yGtPKKG"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Import dei dati DICOM da cartella specifica e visualizzazione 3D del dataset tramite la libreria ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EC94IK8Zh9"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"napari","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DZRI0jGwHv"}],"key":"RxBr1QR4pB"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MRvrJaenk5"}],"key":"zleMTOaP5K"}],"key":"PIz98e0UCe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# set directory\ndirectory = '../data/Phantom_CT_PET/2-CT 2.5mm-5.464/'\n\n# get all files in directory\nfiles = sorted(os.listdir(directory))\nprint(files)\n\n# get info from dicom\nds = pydicom.dcmread(directory + files[0])\nprint(\"Patient ID:\", ds.PatientID)\n\n# get size along 3 axis\nxSize = ds.Rows\nySize = ds.Columns\nzSize = len(files)\nprint(xSize, ySize, zSize)\n\n# get resolution\ndx = ds.PixelSpacing[0]\ndy = ds.PixelSpacing[1]\nloc1 = ds.ImagePositionPatient\nds2  = pydicom.dcmread(directory + files[1])\nloc2 = ds2.ImagePositionPatient\ndz = euclidean(loc1, loc2)\n\n# import volume\nvol = imageio.volread(directory, 'DICOM')\nFOV = [dx*xSize,dy*ySize,dz*zSize]\nprint(\"FOV:\", FOV)\n\n# check  size\nprint(\"dimensioni del dato:\", vol.shape)\n\n#use napari\nviewer = napari.view_image(vol, name = \"my volume\", colormap = \"gray\")\n\n#run the viewer\nnapari.run()","key":"vu5HPNKPW4"},{"type":"outputs","id":"H8oos8pMrbfPYg4w9nO96","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"['000000.dcm', '000001.dcm', '000002.dcm', '000003.dcm', '000004.dcm', '000005.dcm', '000006.dcm', '000007.dcm', '000008.dcm', '000009.dcm', '000010.dcm', '000011.dcm', '000012.dcm', '000013.dcm', '000014.dcm', '000015.dcm', '000016.dcm', '000017.dcm', '000018.dcm', '000019.dcm', '000020.dcm', '000021.dcm', '000022.dcm', '000023.dcm', '000024.dcm', '000025.dcm', '000026.dcm', '000027.dcm', '000028.dcm', '000029.dcm', '000030.dcm', '000031.dcm', '000032.dcm', '000033.dcm', '000034.dcm', '000035.dcm', '000036.dcm', '000037.dcm', '000038.dcm', '000039.dcm', '000040.dcm', '000041.dcm', '000042.dcm', '000043.dcm', '000044.dcm', '000045.dcm', '000046.dcm', '000047.dcm', '000048.dcm', '000049.dcm', '000050.dcm', '000051.dcm', '000052.dcm', '000053.dcm', '000054.dcm', '000055.dcm', '000056.dcm', '000057.dcm', '000058.dcm', '000059.dcm', '000060.dcm', '000061.dcm', '000062.dcm']\nPatient ID: SNMCB04\n512 512 63\nReading DICOM (examining files): 1/63 files (1.6%63/63 files (100.0%)\n  Found 1 correct series.\nReading DICOM (loading data): 63/63  (100.0%)\nFOV: [350.000128, 350.000128, 157.5]\ndimensioni del dato: (63, 512, 512)\n"},"children":[],"key":"WJYCRHRe6h"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_3149/354224610.py:35: FutureWarning: `napari.view_image` is deprecated and will be removed in napari 0.7.0.\nUse `viewer = napari.Viewer(); viewer.add_image(...)` instead.\n  viewer = napari.view_image(vol, name = \"my volume\", colormap = \"gray\")\n"},"children":[],"key":"p2UmDS6t4s"}],"key":"Qpaf8y48lq"}],"key":"I9IdIViJ7A"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione tramite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CrVO5fpV5J"},{"type":"inlineCode","value":"interpn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TikPovxR4y"}],"identifier":"interpolazione-tramite-interpn","label":"Interpolazione tramite interpn","html_id":"interpolazione-tramite-interpn","implicit":true,"key":"kvOcnK7aaU"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Esempio di interpolazione tramite l’utilizzo della funzione ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NRsYp5eXAd"},{"type":"inlineCode","value":"interpn","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"coY2hsPSvi"},{"type":"text","value":" e visualizzazione 3D tramite la libreria ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dyaT9FXYmj"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"napari","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bWA5gKRvul"}],"key":"wGz0TIdu1z"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bHM3dUPDK5"}],"key":"UT8Tg9Ak1A"}],"key":"teMmpmHwYY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# original coordinates\nx = np.arange(0,xSize*dx,dx)\ny = np.arange(0,ySize*dy,dy)\nz = np.arange(0,zSize*dz,dz)\n\n# new coordinates\nnew_x = np.arange(0,xSize*dx,dx)\nnew_y = np.arange(0,ySize*dy,dy)\nnew_z = np.arange(0,(zSize-1)*dz,dx)\n\n# mesh of new coordinates\nnew_coords = np.meshgrid(new_z,new_x, new_y, indexing = 'ij');\nvolumeInt = interpn((z,x,y), vol, np.stack(new_coords,axis=-1))\n\n# check new size\nprint(\"dimensioni dopo interpolazione:\", volumeInt.shape)\n\n# use napari\nviewer = napari.view_image(volumeInt, name = \"my volume interpolated\", colormap = \"gray\")\n\n# run the viewer\nnapari.run()","key":"q9tXYeUySo"},{"type":"outputs","id":"WmD0WiD1dRm0Zk3tWVej7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"dimensioni dopo interpolazione: (227, 512, 512)\n"},"children":[],"key":"sImTPnGX3w"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_3149/298611104.py:19: FutureWarning: `napari.view_image` is deprecated and will be removed in napari 0.7.0.\nUse `viewer = napari.Viewer(); viewer.add_image(...)` instead.\n  viewer = napari.view_image(volumeInt, name = \"my volume interpolated\", colormap = \"gray\")\n"},"children":[],"key":"fMA02lDIBA"}],"key":"jHMXsYRFS4"}],"key":"Avuwiq2Yks"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione tramite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FezR82uKZU"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DqJPVYvxhb"}],"identifier":"interpolazione-tramite-zoom","label":"Interpolazione tramite zoom","html_id":"interpolazione-tramite-zoom","implicit":true,"key":"hFmn0lCynV"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Interpolazione nel piano tramite l’utilizzo della funzione ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oYpeHumbLw"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q9DRK58Xqq"}],"key":"bSlBcBWY2o"}],"key":"e2YFlK2aRF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plane interpolation\nimg = vol[33,:,:]\n\n# original image\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Original\")\nplt.show()\n\n# set scaling factor\nscaling_factors = (2, 2)","key":"CZJMoRXUXp"},{"type":"outputs","id":"NS-_QYKOVjRSRu2CiZ1Pl","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a7f4a104f64900a5343bc6e5915fb76c","path":"/elab_bioimmagini-site/build/a7f4a104f64900a5343bc6e5915fb76c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"mEbctEkacS"}],"key":"FkZtIDCKQx"}],"key":"i0ZAlF6840"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione NN","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TE7kTYy0p3"}],"identifier":"interpolazione-nn","label":"Interpolazione NN","html_id":"interpolazione-nn","implicit":true,"key":"dH1EZt1JM0"}],"key":"cm6VuJofku"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# nearest neighbor\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 0)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"NN\")\nplt.show()","key":"z6uXVWCAej"},{"type":"outputs","id":"RK0XCOn4LwYgxbN2bRawS","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ef409af3b6fddacfe8c46edb09222a39","path":"/elab_bioimmagini-site/build/ef409af3b6fddacfe8c46edb09222a39.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"qe80hxg2dC"}],"key":"BgF37De1uE"}],"key":"zZRJcYLkHl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione bilineare","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y2TTNs0rgh"}],"identifier":"interpolazione-bilineare","label":"Interpolazione bilineare","html_id":"interpolazione-bilineare","implicit":true,"key":"QBLEAb5Npt"}],"key":"d3WoVuxLAI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# bilinear\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 1)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Bilinear\")\nplt.show()\n","key":"xpbRdCv1pO"},{"type":"outputs","id":"wVBGs3KE22CZNbFN2-mVv","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d4f20cff853f4b59148f2922fee2c269","path":"/elab_bioimmagini-site/build/d4f20cff853f4b59148f2922fee2c269.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ljduLnM7SF"}],"key":"XxF6sxFR4K"}],"key":"OXt4DvKNAx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolazione bicubica","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PuxlbZQt82"}],"identifier":"interpolazione-bicubica","label":"Interpolazione bicubica","html_id":"interpolazione-bicubica","implicit":true,"key":"LbB0iImgAk"}],"key":"h2JRdo0kW9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# bicubic\nresized_image = ndi.zoom(img, zoom = scaling_factors, order = 3)\nfig, ax = plt.subplots()\nax.imshow(img, cmap = \"gray\")\nax.set_title(\"Bicubic\")\nplt.show()\n","key":"xYRYxHzKaA"},{"type":"outputs","id":"Jdxzvzh3XZjh9DZ76ea9N","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f165ce5eba3b7c72a9404294b26bbc8b","path":"/elab_bioimmagini-site/build/f165ce5eba3b7c72a9404294b26bbc8b.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"G5uPQLxsjT"}],"key":"pJcB10aZ6R"}],"key":"I93ukUKq83"}],"key":"IEzIyxElZ2"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Capitolo 2: Interpolazione, filtraggio e compressione","url":"/c21-interpolazione-filtraggio-e-compressione-compl","group":"Capitolo2"},"next":{"title":"Esempi di filtraggio - Notebook 2.2","url":"/n-2-2-esempi-filtraggio","group":"Capitolo2"}}},"domain":"http://localhost:3000"}