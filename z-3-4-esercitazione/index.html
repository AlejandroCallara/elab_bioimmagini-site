<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Esercitazione 6: segmentazione dell’albero bronchiale - Elaborazione delle Bioimmagini</title><meta property="og:title" content="Esercitazione 6: segmentazione dell’albero bronchiale - Elaborazione delle Bioimmagini"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png"/><meta property="og:image" content="/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png"/><link rel="stylesheet" href="/elab_bioimmagini-site/build/_assets/app-OIHP3NGU.css"/><link rel="stylesheet" href="/elab_bioimmagini-site/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/elab_bioimmagini-site/favicon.ico"/><link rel="stylesheet" href="/elab_bioimmagini-site/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/elab_bioimmagini-site/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Elaborazione delle Bioimmagini" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/elab_bioimmagini-site/">Elaborazione delle Bioimmagini</a><a title="Contatti" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/elab_bioimmagini-site/c10-info">Contatti</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Capitolo1" class="block break-words rounded py-2 grow cursor-pointer">Capitolo1</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Capitolo2" class="block break-words rounded py-2 grow cursor-pointer">Capitolo2</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Capitolo3" class="block break-words rounded py-2 grow cursor-pointer">Capitolo3</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Capitolo4" class="block break-words rounded py-2 grow cursor-pointer">Capitolo4</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"></div><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Esercitazione 6: segmentazione dell’albero bronchiale</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="contesto-clinico" class="relative group"><span class="heading-text">Contesto clinico</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#contesto-clinico" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>L’analisi dell’albero polmonare è importante in pazienti con insufficienza respiratoria, nei quali per varie patologie si può avere un restringimento del lume bronchiale o una stenosi dei tratti terminali dell’albero. In un soggetto normale le dimensioni delle varie componenti dell’albero sono quelle in Figura 3.69.</p><img id="i8O1XIvQMK" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png" alt="albero" data-canonical-url="./images/image-69.png" class=""/><p><em>Figura 3.69. Dimensione delle componenti dell’albero bronchiale per un soggetto sano.</em></p><p>Attraverso immagini CT ad alta risoluzione è possibile misurare nel singolo paziente la struttura e le dimensioni dell’albero e verificare la presenza di patologie (Figura 3.70). A questo scopo è necessario ricavare la struttura dell’albero per verificare la lunghezza dei vari tratti (seconda colonna della tabella) e misurare il diametro dei vari tratti (prima colonna della tabella).</p><img id="ll6phejpul" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-70-a64a9081fb88eb04295b4a8642ce145c.png" alt="segm-albero" data-canonical-url="./images/image-70.png" class=""/><p><em>Figura 3.70. Esempio di segmentazione dell’albero bronchiale.</em></p><p>Una demo di un software di questo tipo è visibile a <a target="_blank" rel="noreferrer" href="https://www.youtube.com/watch?v=y0CB6Ko_QF4" class="link">https://<wbr/>www<wbr/>.youtube<wbr/>.com<wbr/>/watch<wbr/>?v<wbr/>=<wbr/>y0CB6Ko<wbr/>_QF4<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="external-link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.
Questo tipo di software si basa su operazioni di segmentazione dell’albero bronchiale e di estrazione della struttura dell’albero attraverso algoritmi di <em>skeletonization</em>.</p><h2 id="esercitazione" class="relative group"><span class="heading-text">Esercitazione</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#esercitazione" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>L’esercitazione prevede lo sviluppo di una versione semplificata del software.
In particolare vogliamo ottenere due obiettivi:</p><ol start="1"><li><p>Estrarre dall’immagine l’albero bronchiale (quindi il lume dei bronchi)</p></li><li><p>Misurare il diametro dell’albero scendendo lungo i bronchi.</p></li></ol><p>Naturalmente faremo delle ipotesi semplificative rispetto alle tecniche effettivamente utilizzate nei software clinici. In particolare le immagini fornite coprono solo la prima biforcazione.</p><p>La flow chart del software sarà costituita da una serie di blocchi come quelli riportati in Figura 3.71.</p><img id="JTVwEYB9TC" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-71-e5dcbb42b0e5458d8952feeeca84a472.png" alt="flowchart-segm-albero" data-canonical-url="./images/image-71.png" class=""/><p><em>Figura 3.71. Esempio di flowchart per la segmentazione dell’albero bronchiale.</em></p><p>Il set di dati utilizzato proviene dal Cancer Imaging Archive (<a target="_blank" rel="noreferrer" href="https://www.cancerimagingarchive.net/" class="link">https://<wbr/>www<wbr/>.cancerimagingarchive<wbr/>.net/<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="external-link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>), una repository di dati biomedici anonimizzati che possono essere utilizzati liberamente a scopi di ricerca. I dati sono “labellati” da operatori esperti e quindi possono anche costituire una base di conoscenza per la validazione di algoritmi di analisi dell’immagine. Nel nostro caso utilizziamo le immagini di un paziente dello studio LIDC-IDRI (<a target="_blank" rel="noreferrer" href="https://wiki.cancerimagingarchive.net/pages/viewpage.action?pageId=1966254" class="link">https://<wbr/>wiki<wbr/>.cancerimagingarchive<wbr/>.net<wbr/>/pages<wbr/>/viewpage<wbr/>.action<wbr/>?pageId<wbr/>=<wbr/>1966254<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="external-link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>) dedicato all’identificazioni dei noduli polmonari. Nel nostro caso invece l’obiettivo è studiare l’albero bronchiale del paziente.
Il set di dati è una immagine 3D del torace composta da 148 slice ognuna memorizzata in un file DICOM. Rispetto al volume originale abbiamo la sezione che comprende solo la trachea e i bronchi. I dati DICOM sono memorizzati come numeri di Hounsfield, per cui per leggere correttamente i dati bisogna fare riferimento ai campi RescaleSlope ed RescaleIntercept che la funzione dicomread non utilizza correttamente.
Il volume, una volta caricato in un array, può essere visualizzato in MATLAB tramite la
funzione <code>sliceViewer</code>. In Python, una visualizzazione equivalente di un volume può essere effettuata utilizzando
viewer interattivi come <strong>napari</strong> (visualizzazione slice-by-slice lungo i diversi assi), oppure tramite strumenti di plotting come <strong>matplotlib</strong> per visualizzare singole slice.</p><p>Scorrendo le slides si individua nella prima la trachea (Figura 3.72), che esplorando il volume si suddivide nei due rami bronchiali principali. Il segnale all’interno dell’albero bronchiale è quello dell’aria quindi intorno al valore <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mo>−</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">H = -1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1000</span></span></span></span></span>.</p><img id="lSzachgHws" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-72-0f0e82ce7b6d63520bd176a0149dc2b7.png" alt="trachea-bronchi" data-canonical-url="./images/image-72.png" class=""/><p><em>Figura 3.72. Trachea e rami bronchiali principale.</em></p><p>Il volume ottenuto caricando i dati DICOM in generale non sarà isotropo. E quindi necessario verificare se il volume è isotropo (voxel cubici) ed in caso contrario interpolarlo in modo da ottenere dei voxel cubici. L’interpolazione si effettua mantenendo costante il FOV dell’immagine (dimensione voxel x numero voxel nelle tre dimensioni). Tipicamente si pone la dimensione del voxel del volume interpolato pari alla dimensione del pixel (massima risoluzione).</p><p>Volendo segmentare il lume dei bronchi, è ragionevole utilizzare un algoritmo di tipo region growing che parta da un seed da definire al livello della trachea. MATLAB non implementa l’algoritmo di <em>region growing</em> in 3D, per cui è necessario
implementare questa funzione. Come esempio si fornisce la funzione <code>regionGrowing3D</code>.
La funzione prende in ingresso l’immagine 3D, la tolleranza dell’algoritmo e il seed e
restituisce la maschera dell’oggetto segmentato. In Python, un’implementazione analoga del <em>region growing</em> 3D può essere realizzata
utilizzando funzioni della libreria <strong>scikit-image</strong>, ad esempio <code>skimage.segmentation.flood</code>,
che supporta dati multidimensionali. In questo caso, la funzione riceve in ingresso il
volume 3D, la tolleranza (criterio di similarità) e le coordinate del seed, e restituisce
la maschera binaria dell’oggetto segmentato.</p><p>Come si osserva la funzione utilizza come riferimento per il valore di segnale la media del segnale sulla segmentazione effettuata fino ad un certo punto del ciclo. L’intorno può essere definito come un cubo (26 connessioni) o una sfera (6 connessioni). È naturalmente possibile modificare la funzione per ottimizzare le prestazioni. La funzione è lenta (qualche minuto) quindi una volta effettuata la segmentazione è opportuno salvare la maschera in modo da poterla caricare per ottimizzare le operazioni seguenti. Il risultato dell’algoritmo di region growing sarà una maschera del tipo in Figura 3.73.</p><img id="sLinHK63cc" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-73-d43ea46c704269ab01ca38da4dadcffa.png" alt="trachea-bronchi" data-canonical-url="./images/image-73.png" class=""/><p><em>Figura 3.73. Risultato dell’algoritmo region growing sull’albero bronchiale.</em></p><p>La maschera ottenuta deve essere raffinata attraverso l’uso di filtri che eliminino eventuali “buchi” dovuti alla mancata inclusione di alcuni voxel. Infatti, pixel di background spuri all’interno della maschera farebbero fallire l’algoritmo di skeletonization. La funzione <code>bwmorph3</code> di MATLAB implementa alcuni algoritmi di filtraggio morfologico,
tra cui le operazioni <code>&#x27;fill&#x27;</code> e <code>&#x27;majority&#x27;</code>, particolarmente adatte allo scopo.
In alternativa, è possibile eseguire un algoritmo di <em>labeling</em> sul background e
identificare i “buchi” nella maschera come tutti i blob eccetto quello di dimensione
maggiore. In Python, funzionalità analoghe possono essere ottenute utilizzando la libreria <strong>SciPy</strong>
e <strong>scikit-image</strong>. In particolare, un filtraggio di tipo <em>majority</em> può essere implementato
tramite la funzione <code>scipy.ndimage.generic_filter</code>, definendo opportunamente una funzione
di majority voting. Nella soluzione adottata, il filtraggio è stato realizzato utilizzando
<code>generic_filter</code> con <code>function=majority_filter</code>. Dove</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def majority_filter(window):
    return 1 if np.sum(window) &gt; (len(window) / 2) else 0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Ottenuta la maschera dell’albero bronchiale, la <em>centerline</em> può essere estratta tramite
un algoritmo di <em>skeletonization</em>. In MATLAB tale operazione è implementata dalla funzione
<code>bwskel</code>. Per ottenere uno scheletro più “pulito” è disponibile l’opzione
<code>MinBranchLength</code>, che consente di definire la lunghezza minima dei rami dello scheletro.
Lo scheletro risultante è simile a quello mostrato in figura e la funzione restituisce
una maschera binaria dei voxel appartenenti allo scheletro. In Python, un’operazione equivalente di <em>skeletonization</em> 3D può essere effettuata
utilizzando funzioni della libreria <strong>scikit-image</strong>, come <code>skimage.morphology.skeletonize</code>
(per dati binari) oppure <code>skimage.morphology.medial_axis</code>, che restituisce anche informazioni
sulla distanza dal contorno. La rimozione di rami corti (analoga a <code>MinBranchLength</code>)
può essere implementata tramite operazioni di <em>labeling</em> e filtraggio basato sulla lunghezza
dei rami dello scheletro.</p><p>Una volta ottenuto lo scheletro, in MATLAB la funzione <code>bwmorph3</code> consente di eseguire
ulteriori elaborazioni. Le opzioni <code>&#x27;clean&#x27;</code>, <code>&#x27;fill&#x27;</code> e <code>&#x27;remove&#x27;</code> permettono di
raffinare la forma dello scheletro, mentre l’opzione <code>&#x27;endpoints&#x27;</code> restituisce i punti
terminali dello scheletro. In Python, funzionalità analoghe possono essere realizzate
combinando operazioni di morfologia e <em>labeling</em> in <strong>SciPy</strong> e <strong>scikit-image</strong>; in
particolare, i punti terminali dello scheletro possono essere individuati analizzando
la connettività locale dei voxel scheletrici e utilizzati per identificare l’inizio e
la fine di un tratto dell’albero bronchiale.</p><p>Un esempio dello scheletro dell’albero ottenuto è in Figura 3.74.</p><img id="bYfxEDii9r" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-74-2c8d64a37675e4b8496636be29b61635.png" alt="skel" data-canonical-url="./images/image-74.png" class=""/><p><em>Figura 3.74. Scheletro.</em></p><p>Per la misura del diametro del lume si adopera il metodo della sfera (Figura 3.75), che viene utilizzato nella caratterizzazione di condotti cavi quali i vasi sanguigni. Nel metodo della sfera si considera il diametro del lume pari al diametro della massima sfera con centro situato nel centro di simmetria del vaso (nel nostro caso definito dallo scheletro) inscrivibile nel vaso stesso. In termini algoritmici la sfera è inscrivibile se tutti i suoi voxel appartengono alla maschera del lume.</p><img id="XaxsoXT1SR" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-75-e8abb9ad76e6957e3b94bb8d854d7f37.png" alt="metodo-sfera" data-canonical-url="./images/image-75.png" class=""/><p><em>Figura 3.75. Metodo della sfera.</em></p><p>L’algoritmo per ogni punto della ‘centerline’ prova ad inscrivere sfere di raggio via via maggiore fino a quando la sfera non oltrepassa la maschera del lume. A quel punto memorizza il diametro dell’ultima sfera inscritta.</p><p>Definire la centerline su cui fare la misura per una struttura ramificata come l’albero bronchiale non è banale visto che il numero di percorsi possibili è alto. Di solito si utilizza un approccio simile a quello di Canny per la costruzione dei contorni dalle maschere in cui si tiene conto della distanza dei punti e della direzione di propagazione. Può essere utile la funzione strel che genera un kernel 3D di forma sferica.</p><p>Nel nostro caso possiamo semplificare il problema partendo da un ramo terminale dello scheletro (coordinata z alta) ed andare ad includere punti dello scheletro andando a cercare in modo iterativo il punto più vicino e cancellando dalla lista i punti con valore della coordinata z minore di quella del punto inserito (Figura 3.76).</p><img id="bGUI4fukWq" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-76-8b4a4538b1fabfd7ee1bb584b1e53afc.png" alt="centerline" data-canonical-url="./images/image-76.png" class=""/><p><em>Figura 3.76. Stima della centerline.</em></p><p>La variazione del diametro lungo la centerline partendo dalla trachea dovrebbe risultare un grafico di questo tipo, con un diametro della trachea dell’ordine dei 15-18 mm ed un diametro dei bronchi primari dell’ordine dei 10-12 mm. Un possibile risultato è riportato in Figura 3.77.</p><img id="msvwsW3Q1v" style="margin-left:auto;margin-right:auto" src="/elab_bioimmagini-site/build/image-77-ee96757de24ae47a30c72994e4fa5aac.png" alt="centerline" data-canonical-url="./images/image-77.png" class=""/><p><em>Figura 3.77. Risultato.</em></p><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/elab_bioimmagini-site/z-3-3-esercitazione"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Capitolo3</div>Esercitazione 5: segmentazione del grasso sottocutaneo e viscerale</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/elab_bioimmagini-site/c14-imm-biom"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Capitolo4</div>Capitolo 4: Validazione degli Algoritmi di Analisi dell’Immagine Biomedica</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/elab_bioimmagini-site/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-7UUHRSK3.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/root-EDJFWIEV.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/_shared/chunk-ECLX7DIY.js"/><link rel="modulepreload" href="/elab_bioimmagini-site/build/routes/$-AD65NCUT.js"/><script>window.__remixContext = {"url":"/z-3-4-esercitazione","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.0","options":{},"nav":[],"actions":[],"projects":[{"id":"53034f6b-576e-4e68-b4e4-fdfbc3ff7396","toc":[{"file":"index.md"},{"file":"c10_info.md"},{"file":"README.md"},{"children":[{"file":"capitolo1/c11_imm_biom.md"},{"file":"capitolo1/n_1_1_effetti_corr_imm_entr.ipynb"},{"file":"capitolo1/n_1_2_entropia.ipynb"},{"file":"capitolo1/n_1_3_mr_noise_example.ipynb"},{"file":"capitolo1/z_1_1_esercitazione.md"},{"file":"capitolo1/zn_1_4_profile.ipynb"},{"file":"capitolo1/zn_1_5_test_m_sd.ipynb"},{"file":"capitolo1/zn_1_6_esempio_calcolo_sd.ipynb"}],"title":"Capitolo1"},{"children":[{"file":"capitolo2/c21_interpolazione_filtraggio_e_compressione_completo.md"},{"file":"capitolo2/n_2_1_esempi_interpolazione.ipynb"},{"file":"capitolo2/n_2_2_esempi_filtraggio.ipynb"},{"file":"capitolo2/n_2_3_hist_equalization.ipynb"},{"file":"capitolo2/z_2_1_esercitazione.md"}],"title":"Capitolo2"},{"children":[{"file":"capitolo3/c31_segmentazione.md"},{"file":"capitolo3/n_3_1_seg_soglia.ipynb"},{"file":"capitolo3/n_3_2_esempio_fcm.ipynb"},{"file":"capitolo3/n_3_3_esempio_em_gmm.ipynb"},{"file":"capitolo3/n_3_4_hierarchical_clustering_example.ipynb"},{"file":"capitolo3/n_3_5_esempio_labeling_region_growing.md"},{"file":"capitolo3/n_3_6_seg_contorni.ipynb"},{"file":"capitolo3/n_3_7_watershed_example.ipynb"},{"file":"capitolo3/n_3_8_mser_example.md"},{"file":"capitolo3/n_3_9_connected_tree_example.ipynb"},{"file":"capitolo3/n_3_10_thinning.md"},{"file":"capitolo3/z_3_1_esercitazione.md"},{"file":"capitolo3/z_3_2_esercitazione.md"},{"file":"capitolo3/z_3_3_esercitazione.md"},{"file":"capitolo3/z_3_4_esercitazione.md"}],"title":"Capitolo3"},{"children":[{"file":"capitolo4/c14_imm_biom.md"},{"file":"capitolo4/dice-jaccard-demonstration.ipynb"}],"title":"Capitolo4"}],"exports":[],"bibliography":[],"title":"Elaborazione delle Bioimmagini","index":"index","pages":[{"slug":"c10-info","title":"Contatti","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Capitolo1"},{"slug":"c11-imm-biom","title":"Capitolo 1: Modello dell’immagine biomedica e misure di qualità","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-cc9b77907f3e2da0a7602d87507dca4d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-1-effetti-corr-imm-entr","title":"Esempio degli effetti di corruzione dell’immagine - Notebook 1.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-2-entropia","title":"Stima dell’entropia per diversi tipi di istogramma - Notebook 1.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-3-mr-noise-example","title":"Esempio di rumore riciano in MRI - Notebook 1.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-1-1-esercitazione","title":"Esercitazione 1: stima dei parametri di qualità di un’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-30-68250ded2324d98937077b7f8b06d89a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-4-profile","title":"Effetto del PVE sul profilo - Notebook 1.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-5-test-m-sd","title":"Effetto della dimensione della ROI sulla stima di M e SD - Notebook 1.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-6-esempio-calcolo-sd","title":"Esempio calcolo SD su fantoccio e immagine reale - Notebook 1.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo2"},{"slug":"c21-interpolazione-filtraggio-e-compressione-compl","title":"Capitolo 2: Interpolazione, filtraggio e compressione","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-e579cf81d47ef88091113116464a4e7a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-1-esempi-interpolazione","title":"Esempi di interpolazione - Notebook 2.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-2-esempi-filtraggio","title":"Esempi di filtraggio - Notebook 2.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-3-hist-equalization","title":"Equalizzazione dell’istogramma - Notebook 2.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-2-1-esercitazione","title":"Esercitazione 2: stima dell’effetto di diversi tipi di filtraggio su alcune misure di qualità dell’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-21-15e8de17a941aa924b5d7a45c1ce43c9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo3"},{"slug":"c31-segmentazione","title":"Capitolo 3: Segmentazione dell’immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-6903a5d1f67172d2df5dbc6d97b1416b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-1-seg-soglia","title":"Esempio di segmentazione a soglia - Notebook 3.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-2-esempio-fcm","title":"Esempio di segmentazione con FCM - Notebook 3.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-3-esempio-em-gmm","title":"Esempio di segmentazione con Gaussian Mixtures - Notebook 3.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-4-hierarchical-clustering-example","title":"Esempio di clustering gerarchico - Notebook 3.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-5-esempio-labeling-region-growing","title":"Esempio labeling/region growing - Codice 3.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-6-seg-contorni","title":"Esempio di segmentazione ai contorni - Notebook 3.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-8-mser-example","title":"Esempio di algoritmo mser - Codice 3.8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-9-connected-tree-example","title":"Esempio di component tree - Notebook 3.9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-10-thinning","title":"Esempio algoritmo di thinning - Codice 3.10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-1-esercitazione","title":"Esercitazione 3: segmentazione su immagini di perfusione cardiaca","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-52-359f566b7af23b66482e85d6951121ba.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-2-esercitazione","title":"Esercitazione 4: stima della rigidità arteriosa","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-61-85d1bedc339b4598df4e677293e5387a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-3-esercitazione","title":"Esercitazione 5: segmentazione del grasso sottocutaneo e viscerale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-63-06ea3523bdfbc49734fdb49240ae3ce8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-4-esercitazione","title":"Esercitazione 6: segmentazione dell’albero bronchiale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo4"},{"slug":"c14-imm-biom","title":"Capitolo 4: Validazione degli Algoritmi di Analisi dell’Immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-b1e292b5ba6309c1b977da88b3c0dc28.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dice-jaccard-demonstration","title":"Dice Jaccard Demonstration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/elab_bioimmagini-site"},"routes/$":{"config":{"version":3,"myst":"1.7.0","options":{},"nav":[],"actions":[],"projects":[{"id":"53034f6b-576e-4e68-b4e4-fdfbc3ff7396","toc":[{"file":"index.md"},{"file":"c10_info.md"},{"file":"README.md"},{"children":[{"file":"capitolo1/c11_imm_biom.md"},{"file":"capitolo1/n_1_1_effetti_corr_imm_entr.ipynb"},{"file":"capitolo1/n_1_2_entropia.ipynb"},{"file":"capitolo1/n_1_3_mr_noise_example.ipynb"},{"file":"capitolo1/z_1_1_esercitazione.md"},{"file":"capitolo1/zn_1_4_profile.ipynb"},{"file":"capitolo1/zn_1_5_test_m_sd.ipynb"},{"file":"capitolo1/zn_1_6_esempio_calcolo_sd.ipynb"}],"title":"Capitolo1"},{"children":[{"file":"capitolo2/c21_interpolazione_filtraggio_e_compressione_completo.md"},{"file":"capitolo2/n_2_1_esempi_interpolazione.ipynb"},{"file":"capitolo2/n_2_2_esempi_filtraggio.ipynb"},{"file":"capitolo2/n_2_3_hist_equalization.ipynb"},{"file":"capitolo2/z_2_1_esercitazione.md"}],"title":"Capitolo2"},{"children":[{"file":"capitolo3/c31_segmentazione.md"},{"file":"capitolo3/n_3_1_seg_soglia.ipynb"},{"file":"capitolo3/n_3_2_esempio_fcm.ipynb"},{"file":"capitolo3/n_3_3_esempio_em_gmm.ipynb"},{"file":"capitolo3/n_3_4_hierarchical_clustering_example.ipynb"},{"file":"capitolo3/n_3_5_esempio_labeling_region_growing.md"},{"file":"capitolo3/n_3_6_seg_contorni.ipynb"},{"file":"capitolo3/n_3_7_watershed_example.ipynb"},{"file":"capitolo3/n_3_8_mser_example.md"},{"file":"capitolo3/n_3_9_connected_tree_example.ipynb"},{"file":"capitolo3/n_3_10_thinning.md"},{"file":"capitolo3/z_3_1_esercitazione.md"},{"file":"capitolo3/z_3_2_esercitazione.md"},{"file":"capitolo3/z_3_3_esercitazione.md"},{"file":"capitolo3/z_3_4_esercitazione.md"}],"title":"Capitolo3"},{"children":[{"file":"capitolo4/c14_imm_biom.md"},{"file":"capitolo4/dice-jaccard-demonstration.ipynb"}],"title":"Capitolo4"}],"exports":[],"bibliography":[],"title":"Elaborazione delle Bioimmagini","index":"index","pages":[{"slug":"c10-info","title":"Contatti","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Capitolo1"},{"slug":"c11-imm-biom","title":"Capitolo 1: Modello dell’immagine biomedica e misure di qualità","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-cc9b77907f3e2da0a7602d87507dca4d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-1-effetti-corr-imm-entr","title":"Esempio degli effetti di corruzione dell’immagine - Notebook 1.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-2-entropia","title":"Stima dell’entropia per diversi tipi di istogramma - Notebook 1.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-3-mr-noise-example","title":"Esempio di rumore riciano in MRI - Notebook 1.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-1-1-esercitazione","title":"Esercitazione 1: stima dei parametri di qualità di un’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-30-68250ded2324d98937077b7f8b06d89a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-4-profile","title":"Effetto del PVE sul profilo - Notebook 1.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-5-test-m-sd","title":"Effetto della dimensione della ROI sulla stima di M e SD - Notebook 1.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-6-esempio-calcolo-sd","title":"Esempio calcolo SD su fantoccio e immagine reale - Notebook 1.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo2"},{"slug":"c21-interpolazione-filtraggio-e-compressione-compl","title":"Capitolo 2: Interpolazione, filtraggio e compressione","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-e579cf81d47ef88091113116464a4e7a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-1-esempi-interpolazione","title":"Esempi di interpolazione - Notebook 2.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-2-esempi-filtraggio","title":"Esempi di filtraggio - Notebook 2.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-3-hist-equalization","title":"Equalizzazione dell’istogramma - Notebook 2.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-2-1-esercitazione","title":"Esercitazione 2: stima dell’effetto di diversi tipi di filtraggio su alcune misure di qualità dell’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-21-15e8de17a941aa924b5d7a45c1ce43c9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo3"},{"slug":"c31-segmentazione","title":"Capitolo 3: Segmentazione dell’immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-6903a5d1f67172d2df5dbc6d97b1416b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-1-seg-soglia","title":"Esempio di segmentazione a soglia - Notebook 3.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-2-esempio-fcm","title":"Esempio di segmentazione con FCM - Notebook 3.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-3-esempio-em-gmm","title":"Esempio di segmentazione con Gaussian Mixtures - Notebook 3.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-4-hierarchical-clustering-example","title":"Esempio di clustering gerarchico - Notebook 3.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-5-esempio-labeling-region-growing","title":"Esempio labeling/region growing - Codice 3.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-6-seg-contorni","title":"Esempio di segmentazione ai contorni - Notebook 3.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-8-mser-example","title":"Esempio di algoritmo mser - Codice 3.8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-9-connected-tree-example","title":"Esempio di component tree - Notebook 3.9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-10-thinning","title":"Esempio algoritmo di thinning - Codice 3.10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-1-esercitazione","title":"Esercitazione 3: segmentazione su immagini di perfusione cardiaca","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-52-359f566b7af23b66482e85d6951121ba.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-2-esercitazione","title":"Esercitazione 4: stima della rigidità arteriosa","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-61-85d1bedc339b4598df4e677293e5387a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-3-esercitazione","title":"Esercitazione 5: segmentazione del grasso sottocutaneo e viscerale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-63-06ea3523bdfbc49734fdb49240ae3ce8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-4-esercitazione","title":"Esercitazione 6: segmentazione dell’albero bronchiale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo4"},{"slug":"c14-imm-biom","title":"Capitolo 4: Validazione degli Algoritmi di Analisi dell’Immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-b1e292b5ba6309c1b977da88b3c0dc28.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dice-jaccard-demonstration","title":"Dice Jaccard Demonstration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Article","sha256":"4daae27de012122342ecc3258e30cbe6efb3e7b7c977ad34aee715aa55d945f8","slug":"z-3-4-esercitazione","location":"/capitolo3/z_3_4_esercitazione.md","dependencies":[],"frontmatter":{"title":"Esercitazione 6: segmentazione dell’albero bronchiale","content_includes_title":false,"numbering":{"title":{"offset":1}},"thumbnail":"/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png","exports":[{"format":"md","filename":"z_3_4_esercitazione.md","url":"/elab_bioimmagini-site/build/z_3_4_esercitazione-3c4d63259d4961b347e170e6a75f9148.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Contesto clinico","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xDaTZvHzsO"}],"identifier":"contesto-clinico","label":"Contesto clinico","html_id":"contesto-clinico","implicit":true,"key":"YNApRxOIwA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’analisi dell’albero polmonare è importante in pazienti con insufficienza respiratoria, nei quali per varie patologie si può avere un restringimento del lume bronchiale o una stenosi dei tratti terminali dell’albero. In un soggetto normale le dimensioni delle varie componenti dell’albero sono quelle in Figura 3.69.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rLJ0Ogrn4Q"}],"key":"tokWPGz21K"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png","alt":"albero","key":"i8O1XIvQMK","urlSource":"./images/image-69.png"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Figura 3.69. Dimensione delle componenti dell’albero bronchiale per un soggetto sano.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ohG6Eej5vR"}],"key":"wSLhhINgld"}],"key":"la8Qpeabcg"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Attraverso immagini CT ad alta risoluzione è possibile misurare nel singolo paziente la struttura e le dimensioni dell’albero e verificare la presenza di patologie (Figura 3.70). A questo scopo è necessario ricavare la struttura dell’albero per verificare la lunghezza dei vari tratti (seconda colonna della tabella) e misurare il diametro dei vari tratti (prima colonna della tabella).","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SZqM4kz5uE"}],"key":"EUyI3PrT6y"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-70-a64a9081fb88eb04295b4a8642ce145c.png","alt":"segm-albero","key":"ll6phejpul","urlSource":"./images/image-70.png"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Figura 3.70. Esempio di segmentazione dell’albero bronchiale.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"czN8eVwsck"}],"key":"mNPBKzbtVn"}],"key":"euC99TwbSw"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Una demo di un software di questo tipo è visibile a ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"u5oVVI5Kdi"},{"type":"link","url":"https://www.youtube.com/watch?v=y0CB6Ko_QF4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"https://​www​.youtube​.com​/watch​?v​=​y0CB6Ko​_QF4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BtJAupKNyd"}],"urlSource":"https://www.youtube.com/watch?v=y0CB6Ko_QF4","key":"nvmjCkwwGb"},{"type":"text","value":".\nQuesto tipo di software si basa su operazioni di segmentazione dell’albero bronchiale e di estrazione della struttura dell’albero attraverso algoritmi di ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uxs2biUzDx"},{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"skeletonization","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"s4r28dvIUu"}],"key":"OUnOi2Pt1q"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gcBl17rdp2"}],"key":"EImQ11eRMA"},{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Esercitazione","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"JvUi0EXgF2"}],"identifier":"esercitazione","label":"Esercitazione","html_id":"esercitazione","implicit":true,"key":"SV38hI0d6C"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"L’esercitazione prevede lo sviluppo di una versione semplificata del software.\nIn particolare vogliamo ottenere due obiettivi:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IzyOszkwOn"}],"key":"dypiAaBo17"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Estrarre dall’immagine l’albero bronchiale (quindi il lume dei bronchi)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"qq6oYPItWh"}],"key":"eXOZ7b97y4"}],"key":"qFX4QWdRWK"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Misurare il diametro dell’albero scendendo lungo i bronchi.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"wyL9KLwk7l"}],"key":"cbKcsDrKkg"}],"key":"wtSGYzxmIU"}],"key":"QZIqqDQGxv"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Naturalmente faremo delle ipotesi semplificative rispetto alle tecniche effettivamente utilizzate nei software clinici. In particolare le immagini fornite coprono solo la prima biforcazione.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Bxq0KMzonb"}],"key":"VusJQ3Bizf"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"La flow chart del software sarà costituita da una serie di blocchi come quelli riportati in Figura 3.71.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"sIYK1kWIvq"}],"key":"Bdl1bvuMgC"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-71-e5dcbb42b0e5458d8952feeeca84a472.png","alt":"flowchart-segm-albero","key":"JTVwEYB9TC","urlSource":"./images/image-71.png"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Figura 3.71. Esempio di flowchart per la segmentazione dell’albero bronchiale.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"O6zleFb7AM"}],"key":"GrlePmDnuR"}],"key":"mwnmtxKtfD"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Il set di dati utilizzato proviene dal Cancer Imaging Archive (","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"wuL6T8BSbj"},{"type":"link","url":"https://www.cancerimagingarchive.net/","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"https://​www​.cancerimagingarchive​.net/","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"rfJCMEQFOe"}],"urlSource":"https://www.cancerimagingarchive.net/","key":"LTKacbVTET"},{"type":"text","value":"), una repository di dati biomedici anonimizzati che possono essere utilizzati liberamente a scopi di ricerca. I dati sono “labellati” da operatori esperti e quindi possono anche costituire una base di conoscenza per la validazione di algoritmi di analisi dell’immagine. Nel nostro caso utilizziamo le immagini di un paziente dello studio LIDC-IDRI (","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"jci6ocHZmk"},{"type":"link","url":"https://wiki.cancerimagingarchive.net/pages/viewpage.action?pageId=1966254","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"https://​wiki​.cancerimagingarchive​.net​/pages​/viewpage​.action​?pageId​=​1966254","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"DJ4KCf9LTN"}],"urlSource":"https://wiki.cancerimagingarchive.net/pages/viewpage.action?pageId=1966254","key":"fctUIsjaqP"},{"type":"text","value":") dedicato all’identificazioni dei noduli polmonari. Nel nostro caso invece l’obiettivo è studiare l’albero bronchiale del paziente.\nIl set di dati è una immagine 3D del torace composta da 148 slice ognuna memorizzata in un file DICOM. Rispetto al volume originale abbiamo la sezione che comprende solo la trachea e i bronchi. I dati DICOM sono memorizzati come numeri di Hounsfield, per cui per leggere correttamente i dati bisogna fare riferimento ai campi RescaleSlope ed RescaleIntercept che la funzione dicomread non utilizza correttamente.\nIl volume, una volta caricato in un array, può essere visualizzato in MATLAB tramite la\nfunzione ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"l6ANhvle6P"},{"type":"inlineCode","value":"sliceViewer","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"N66ynvTBXe"},{"type":"text","value":". In Python, una visualizzazione equivalente di un volume può essere effettuata utilizzando\nviewer interattivi come ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"IriJUg2naO"},{"type":"strong","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"napari","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"W6VeLVahjZ"}],"key":"bzp1qa1211"},{"type":"text","value":" (visualizzazione slice-by-slice lungo i diversi assi), oppure tramite strumenti di plotting come ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"FFkYpOlNkb"},{"type":"strong","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"matplotlib","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"d5ti5Nl4Tu"}],"key":"o5OFjxfnQm"},{"type":"text","value":" per visualizzare singole slice.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"iiVwabeeBH"}],"key":"E6hzVEiiGu"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Scorrendo le slides si individua nella prima la trachea (Figura 3.72), che esplorando il volume si suddivide nei due rami bronchiali principali. Il segnale all’interno dell’albero bronchiale è quello dell’aria quindi intorno al valore ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Ac8UwVCs56"},{"type":"inlineMath","value":"H = -1000","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1000\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eH = -1000\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.08125em;\"\u003eH\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1000\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ev7wlTz0t2"},{"type":"text","value":".","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"KrqaKWO4vc"}],"key":"UulXPnclFh"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-72-0f0e82ce7b6d63520bd176a0149dc2b7.png","alt":"trachea-bronchi","key":"lSzachgHws","urlSource":"./images/image-72.png"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Figura 3.72. Trachea e rami bronchiali principale.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"nYLpUWmmxK"}],"key":"gMA2jB2iEX"}],"key":"XVYl3eFIXq"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Il volume ottenuto caricando i dati DICOM in generale non sarà isotropo. E quindi necessario verificare se il volume è isotropo (voxel cubici) ed in caso contrario interpolarlo in modo da ottenere dei voxel cubici. L’interpolazione si effettua mantenendo costante il FOV dell’immagine (dimensione voxel x numero voxel nelle tre dimensioni). Tipicamente si pone la dimensione del voxel del volume interpolato pari alla dimensione del pixel (massima risoluzione).","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Cm3TWDjTHD"}],"key":"NWRzDzwgJ7"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Volendo segmentare il lume dei bronchi, è ragionevole utilizzare un algoritmo di tipo region growing che parta da un seed da definire al livello della trachea. MATLAB non implementa l’algoritmo di ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"Uo3HjhbBYp"},{"type":"emphasis","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"region growing","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"GJOjVIJl0s"}],"key":"ip3cctpX1b"},{"type":"text","value":" in 3D, per cui è necessario\nimplementare questa funzione. Come esempio si fornisce la funzione ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"nHu0ILIXV2"},{"type":"inlineCode","value":"regionGrowing3D","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"lPPiQFrvNN"},{"type":"text","value":".\nLa funzione prende in ingresso l’immagine 3D, la tolleranza dell’algoritmo e il seed e\nrestituisce la maschera dell’oggetto segmentato. In Python, un’implementazione analoga del ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"FEZLI8FZjo"},{"type":"emphasis","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"region growing","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"z75ggFvJJ7"}],"key":"vmRW3XFxFg"},{"type":"text","value":" 3D può essere realizzata\nutilizzando funzioni della libreria ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"HgwRHhDka0"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"scikit-image","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"poWStxKVhi"}],"key":"n2JDDsyWhI"},{"type":"text","value":", ad esempio ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"L63qK7GNFM"},{"type":"inlineCode","value":"skimage.segmentation.flood","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"KDMRZ4fNs4"},{"type":"text","value":",\nche supporta dati multidimensionali. In questo caso, la funzione riceve in ingresso il\nvolume 3D, la tolleranza (criterio di similarità) e le coordinate del seed, e restituisce\nla maschera binaria dell’oggetto segmentato.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"d6j4mitWnk"}],"key":"VwnHVPc5Kl"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Come si osserva la funzione utilizza come riferimento per il valore di segnale la media del segnale sulla segmentazione effettuata fino ad un certo punto del ciclo. L’intorno può essere definito come un cubo (26 connessioni) o una sfera (6 connessioni). È naturalmente possibile modificare la funzione per ottimizzare le prestazioni. La funzione è lenta (qualche minuto) quindi una volta effettuata la segmentazione è opportuno salvare la maschera in modo da poterla caricare per ottimizzare le operazioni seguenti. Il risultato dell’algoritmo di region growing sarà una maschera del tipo in Figura 3.73.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"eCnyTJMOJW"}],"key":"NNMM7xySI2"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-73-d43ea46c704269ab01ca38da4dadcffa.png","alt":"trachea-bronchi","key":"sLinHK63cc","urlSource":"./images/image-73.png"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Figura 3.73. Risultato dell’algoritmo region growing sull’albero bronchiale.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"aOQIoRT2zi"}],"key":"jCl9lCLRV6"}],"key":"MPmY1RmBIA"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"La maschera ottenuta deve essere raffinata attraverso l’uso di filtri che eliminino eventuali “buchi” dovuti alla mancata inclusione di alcuni voxel. Infatti, pixel di background spuri all’interno della maschera farebbero fallire l’algoritmo di skeletonization. La funzione ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"X9ykmVD0xi"},{"type":"inlineCode","value":"bwmorph3","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"TVrdrVwAZH"},{"type":"text","value":" di MATLAB implementa alcuni algoritmi di filtraggio morfologico,\ntra cui le operazioni ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"tz9YkwKsng"},{"type":"inlineCode","value":"'fill'","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"dDpJu34wp1"},{"type":"text","value":" e ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Eb1TH3wdHq"},{"type":"inlineCode","value":"'majority'","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Q81bjRWlyh"},{"type":"text","value":", particolarmente adatte allo scopo.\nIn alternativa, è possibile eseguire un algoritmo di ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Im0Nb2B3am"},{"type":"emphasis","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"labeling","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"sBr8sZxpIj"}],"key":"cSvdBgk2yf"},{"type":"text","value":" sul background e\nidentificare i “buchi” nella maschera come tutti i blob eccetto quello di dimensione\nmaggiore. In Python, funzionalità analoghe possono essere ottenute utilizzando la libreria ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"onm9MaYm6M"},{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"SciPy","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"qeC56QkeTH"}],"key":"ZzS8cM0wUE"},{"type":"text","value":"\ne ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ewAzjv6b4j"},{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"scikit-image","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"m2MyzxoFsg"}],"key":"BIyTG2G2Gu"},{"type":"text","value":". In particolare, un filtraggio di tipo ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"OkBNoREvgU"},{"type":"emphasis","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"majority","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ZguOt9sYEN"}],"key":"DsILAVr8WY"},{"type":"text","value":" può essere implementato\ntramite la funzione ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"s5DJLozeft"},{"type":"inlineCode","value":"scipy.ndimage.generic_filter","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"cZXqJgh1PV"},{"type":"text","value":", definendo opportunamente una funzione\ndi majority voting. Nella soluzione adottata, il filtraggio è stato realizzato utilizzando\n","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"gF89wK6YJ9"},{"type":"inlineCode","value":"generic_filter","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"SrtJcQnNuQ"},{"type":"text","value":" con ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"pMC8gi8jWd"},{"type":"inlineCode","value":"function=majority_filter","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Nza2h1lPkJ"},{"type":"text","value":". Dove","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"IVHsNOJauX"}],"key":"ZpDfKKJEn1"},{"type":"code","lang":"python","value":"def majority_filter(window):\n    return 1 if np.sum(window) \u003e (len(window) / 2) else 0","position":{"start":{"line":70,"column":1},"end":{"line":73,"column":1}},"key":"CvgPdDVuyJ"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Ottenuta la maschera dell’albero bronchiale, la ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"k815KlHmDN"},{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"centerline","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"iWeCdaRLOP"}],"key":"G5O5VAeIGk"},{"type":"text","value":" può essere estratta tramite\nun algoritmo di ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"CG2Z92sBCo"},{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"skeletonization","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"v7bAydKYvH"}],"key":"x7m4BPlzfe"},{"type":"text","value":". In MATLAB tale operazione è implementata dalla funzione\n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"xMiiLmD5re"},{"type":"inlineCode","value":"bwskel","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"usbuQkvjaO"},{"type":"text","value":". Per ottenere uno scheletro più “pulito” è disponibile l’opzione\n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"qTgQ7uYXZo"},{"type":"inlineCode","value":"MinBranchLength","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"sDz07aYTWl"},{"type":"text","value":", che consente di definire la lunghezza minima dei rami dello scheletro.\nLo scheletro risultante è simile a quello mostrato in figura e la funzione restituisce\nuna maschera binaria dei voxel appartenenti allo scheletro. In Python, un’operazione equivalente di ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"vwGjxMS7Af"},{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"skeletonization","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"HDlpbFLbPz"}],"key":"KhiAgwGMKz"},{"type":"text","value":" 3D può essere effettuata\nutilizzando funzioni della libreria ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"VaEbgXmCPe"},{"type":"strong","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"scikit-image","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"UCNmZ1b3R0"}],"key":"xtKXgrbxaG"},{"type":"text","value":", come ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"xzNYC9pWAX"},{"type":"inlineCode","value":"skimage.morphology.skeletonize","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"GIMBaJApJ5"},{"type":"text","value":"\n(per dati binari) oppure ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"VaMEdTaYxq"},{"type":"inlineCode","value":"skimage.morphology.medial_axis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"T100G9H3Yj"},{"type":"text","value":", che restituisce anche informazioni\nsulla distanza dal contorno. La rimozione di rami corti (analoga a ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"e56QpHgg79"},{"type":"inlineCode","value":"MinBranchLength","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"jdDRu29wlo"},{"type":"text","value":")\npuò essere implementata tramite operazioni di ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"eVlN59cWdx"},{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"labeling","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"HDXn55B1Ha"}],"key":"BVf2S8PcAc"},{"type":"text","value":" e filtraggio basato sulla lunghezza\ndei rami dello scheletro.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"BlZD6prwIE"}],"key":"jOzNIoIcLs"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Una volta ottenuto lo scheletro, in MATLAB la funzione ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"f2bF93nxBn"},{"type":"inlineCode","value":"bwmorph3","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"jp37Nsyf11"},{"type":"text","value":" consente di eseguire\nulteriori elaborazioni. Le opzioni ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"gJPFkGppoi"},{"type":"inlineCode","value":"'clean'","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"mQ9IPGFBvE"},{"type":"text","value":", ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"ZD8zYa9T39"},{"type":"inlineCode","value":"'fill'","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"L978DFI5HP"},{"type":"text","value":" e ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"qqURStpoaP"},{"type":"inlineCode","value":"'remove'","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"MgCWRsYoye"},{"type":"text","value":" permettono di\nraffinare la forma dello scheletro, mentre l’opzione ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"kHI12Kx2VQ"},{"type":"inlineCode","value":"'endpoints'","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"fp3BRD1IF9"},{"type":"text","value":" restituisce i punti\nterminali dello scheletro. In Python, funzionalità analoghe possono essere realizzate\ncombinando operazioni di morfologia e ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"zP59NtYzBs"},{"type":"emphasis","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"labeling","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"UsIsXczkMe"}],"key":"k8sAAw6Caz"},{"type":"text","value":" in ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"h6cvzDqDvZ"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"SciPy","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"dzEgVCju5i"}],"key":"gXfSIcN62y"},{"type":"text","value":" e ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"WIqY09N213"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"scikit-image","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Bepga1gLSj"}],"key":"IhDd2UdmWg"},{"type":"text","value":"; in\nparticolare, i punti terminali dello scheletro possono essere individuati analizzando\nla connettività locale dei voxel scheletrici e utilizzati per identificare l’inizio e\nla fine di un tratto dell’albero bronchiale.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"mRwnDhw0at"}],"key":"Lwg3Sy1xqF"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Un esempio dello scheletro dell’albero ottenuto è in Figura 3.74.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"XR98gf7HFX"}],"key":"VYjx5Kh1nb"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-74-2c8d64a37675e4b8496636be29b61635.png","alt":"skel","key":"bYfxEDii9r","urlSource":"./images/image-74.png"},{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"Figura 3.74. Scheletro.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"DSkssY9ntd"}],"key":"EkhD99AuzT"}],"key":"d5USgtSB8s"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Per la misura del diametro del lume si adopera il metodo della sfera (Figura 3.75), che viene utilizzato nella caratterizzazione di condotti cavi quali i vasi sanguigni. Nel metodo della sfera si considera il diametro del lume pari al diametro della massima sfera con centro situato nel centro di simmetria del vaso (nel nostro caso definito dallo scheletro) inscrivibile nel vaso stesso. In termini algoritmici la sfera è inscrivibile se tutti i suoi voxel appartengono alla maschera del lume.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"xnROcIdV8J"}],"key":"YcO9AhtQAY"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-75-e8abb9ad76e6957e3b94bb8d854d7f37.png","alt":"metodo-sfera","key":"XaxsoXT1SR","urlSource":"./images/image-75.png"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"Figura 3.75. Metodo della sfera.","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"GcOkzS7f0f"}],"key":"UszGFX7aBH"}],"key":"Tf9Jqszy5N"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"L’algoritmo per ogni punto della ‘centerline’ prova ad inscrivere sfere di raggio via via maggiore fino a quando la sfera non oltrepassa la maschera del lume. A quel punto memorizza il diametro dell’ultima sfera inscritta.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"Egw4cbj6kI"}],"key":"zN71k3GlcY"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Definire la centerline su cui fare la misura per una struttura ramificata come l’albero bronchiale non è banale visto che il numero di percorsi possibili è alto. Di solito si utilizza un approccio simile a quello di Canny per la costruzione dei contorni dalle maschere in cui si tiene conto della distanza dei punti e della direzione di propagazione. Può essere utile la funzione strel che genera un kernel 3D di forma sferica.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"dcftmFT7Sb"}],"key":"LARJ3iuVec"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Nel nostro caso possiamo semplificare il problema partendo da un ramo terminale dello scheletro (coordinata z alta) ed andare ad includere punti dello scheletro andando a cercare in modo iterativo il punto più vicino e cancellando dalla lista i punti con valore della coordinata z minore di quella del punto inserito (Figura 3.76).","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"XuBvCunTjO"}],"key":"el0itLHOaD"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-76-8b4a4538b1fabfd7ee1bb584b1e53afc.png","alt":"centerline","key":"bGUI4fukWq","urlSource":"./images/image-76.png"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Figura 3.76. Stima della centerline.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"xsIhHGYe6U"}],"key":"tt68WzncIk"}],"key":"hsnG66LPqS"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"La variazione del diametro lungo la centerline partendo dalla trachea dovrebbe risultare un grafico di questo tipo, con un diametro della trachea dell’ordine dei 15-18 mm ed un diametro dei bronchi primari dell’ordine dei 10-12 mm. Un possibile risultato è riportato in Figura 3.77.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"Tyz9fhPK8p"}],"key":"uft1DvNYz0"},{"type":"image","style":{"width":"100%"},"url":"/elab_bioimmagini-site/build/image-77-ee96757de24ae47a30c72994e4fa5aac.png","alt":"centerline","key":"msvwsW3Q1v","urlSource":"./images/image-77.png"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Figura 3.77. Risultato.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"lEtLCxqeLj"}],"key":"qU457QGS49"}],"key":"SEzGOAqCOt"}],"key":"n75Hrjtxaq"}],"key":"ewv8hUXebu"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esercitazione 5: segmentazione del grasso sottocutaneo e viscerale","url":"/z-3-3-esercitazione","group":"Capitolo3"},"next":{"title":"Capitolo 4: Validazione degli Algoritmi di Analisi dell’Immagine Biomedica","url":"/c14-imm-biom","group":"Capitolo4"}}},"domain":"http://localhost:3000"},"project":{"id":"53034f6b-576e-4e68-b4e4-fdfbc3ff7396","toc":[{"file":"index.md"},{"file":"c10_info.md"},{"file":"README.md"},{"children":[{"file":"capitolo1/c11_imm_biom.md"},{"file":"capitolo1/n_1_1_effetti_corr_imm_entr.ipynb"},{"file":"capitolo1/n_1_2_entropia.ipynb"},{"file":"capitolo1/n_1_3_mr_noise_example.ipynb"},{"file":"capitolo1/z_1_1_esercitazione.md"},{"file":"capitolo1/zn_1_4_profile.ipynb"},{"file":"capitolo1/zn_1_5_test_m_sd.ipynb"},{"file":"capitolo1/zn_1_6_esempio_calcolo_sd.ipynb"}],"title":"Capitolo1"},{"children":[{"file":"capitolo2/c21_interpolazione_filtraggio_e_compressione_completo.md"},{"file":"capitolo2/n_2_1_esempi_interpolazione.ipynb"},{"file":"capitolo2/n_2_2_esempi_filtraggio.ipynb"},{"file":"capitolo2/n_2_3_hist_equalization.ipynb"},{"file":"capitolo2/z_2_1_esercitazione.md"}],"title":"Capitolo2"},{"children":[{"file":"capitolo3/c31_segmentazione.md"},{"file":"capitolo3/n_3_1_seg_soglia.ipynb"},{"file":"capitolo3/n_3_2_esempio_fcm.ipynb"},{"file":"capitolo3/n_3_3_esempio_em_gmm.ipynb"},{"file":"capitolo3/n_3_4_hierarchical_clustering_example.ipynb"},{"file":"capitolo3/n_3_5_esempio_labeling_region_growing.md"},{"file":"capitolo3/n_3_6_seg_contorni.ipynb"},{"file":"capitolo3/n_3_7_watershed_example.ipynb"},{"file":"capitolo3/n_3_8_mser_example.md"},{"file":"capitolo3/n_3_9_connected_tree_example.ipynb"},{"file":"capitolo3/n_3_10_thinning.md"},{"file":"capitolo3/z_3_1_esercitazione.md"},{"file":"capitolo3/z_3_2_esercitazione.md"},{"file":"capitolo3/z_3_3_esercitazione.md"},{"file":"capitolo3/z_3_4_esercitazione.md"}],"title":"Capitolo3"},{"children":[{"file":"capitolo4/c14_imm_biom.md"},{"file":"capitolo4/dice-jaccard-demonstration.ipynb"}],"title":"Capitolo4"}],"exports":[],"bibliography":[],"title":"Elaborazione delle Bioimmagini","index":"index","pages":[{"slug":"c10-info","title":"Contatti","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Capitolo1"},{"slug":"c11-imm-biom","title":"Capitolo 1: Modello dell’immagine biomedica e misure di qualità","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-cc9b77907f3e2da0a7602d87507dca4d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-1-effetti-corr-imm-entr","title":"Esempio degli effetti di corruzione dell’immagine - Notebook 1.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-2-entropia","title":"Stima dell’entropia per diversi tipi di istogramma - Notebook 1.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-1-3-mr-noise-example","title":"Esempio di rumore riciano in MRI - Notebook 1.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-1-1-esercitazione","title":"Esercitazione 1: stima dei parametri di qualità di un’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-30-68250ded2324d98937077b7f8b06d89a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-4-profile","title":"Effetto del PVE sul profilo - Notebook 1.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-5-test-m-sd","title":"Effetto della dimensione della ROI sulla stima di M e SD - Notebook 1.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zn-1-6-esempio-calcolo-sd","title":"Esempio calcolo SD su fantoccio e immagine reale - Notebook 1.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo2"},{"slug":"c21-interpolazione-filtraggio-e-compressione-compl","title":"Capitolo 2: Interpolazione, filtraggio e compressione","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-e579cf81d47ef88091113116464a4e7a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-1-esempi-interpolazione","title":"Esempi di interpolazione - Notebook 2.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-2-esempi-filtraggio","title":"Esempi di filtraggio - Notebook 2.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-2-3-hist-equalization","title":"Equalizzazione dell’istogramma - Notebook 2.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-2-1-esercitazione","title":"Esercitazione 2: stima dell’effetto di diversi tipi di filtraggio su alcune misure di qualità dell’immagine biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-21-15e8de17a941aa924b5d7a45c1ce43c9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo3"},{"slug":"c31-segmentazione","title":"Capitolo 3: Segmentazione dell’immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-6903a5d1f67172d2df5dbc6d97b1416b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-1-seg-soglia","title":"Esempio di segmentazione a soglia - Notebook 3.1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-2-esempio-fcm","title":"Esempio di segmentazione con FCM - Notebook 3.2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-3-esempio-em-gmm","title":"Esempio di segmentazione con Gaussian Mixtures - Notebook 3.3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-4-hierarchical-clustering-example","title":"Esempio di clustering gerarchico - Notebook 3.4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-5-esempio-labeling-region-growing","title":"Esempio labeling/region growing - Codice 3.5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-6-seg-contorni","title":"Esempio di segmentazione ai contorni - Notebook 3.6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-8-mser-example","title":"Esempio di algoritmo mser - Codice 3.8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-9-connected-tree-example","title":"Esempio di component tree - Notebook 3.9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"n-3-10-thinning","title":"Esempio algoritmo di thinning - Codice 3.10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-1-esercitazione","title":"Esercitazione 3: segmentazione su immagini di perfusione cardiaca","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-52-359f566b7af23b66482e85d6951121ba.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-2-esercitazione","title":"Esercitazione 4: stima della rigidità arteriosa","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-61-85d1bedc339b4598df4e677293e5387a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-3-esercitazione","title":"Esercitazione 5: segmentazione del grasso sottocutaneo e viscerale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-63-06ea3523bdfbc49734fdb49240ae3ce8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"z-3-4-esercitazione","title":"Esercitazione 6: segmentazione dell’albero bronchiale","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-69-79e5d2e04504089bd21f085580c7a7cc.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Capitolo4"},{"slug":"c14-imm-biom","title":"Capitolo 4: Validazione degli Algoritmi di Analisi dell’Immagine Biomedica","description":"","date":"","thumbnail":"/elab_bioimmagini-site/build/image-1-b1e292b5ba6309c1b977da88b3c0dc28.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dice-jaccard-demonstration","title":"Dice Jaccard Demonstration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/elab_bioimmagini-site/build/manifest-7B0967AD.js";
import * as route0 from "/elab_bioimmagini-site/build/root-EDJFWIEV.js";
import * as route1 from "/elab_bioimmagini-site/build/routes/$-AD65NCUT.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/elab_bioimmagini-site/build/entry.client-PCJPW7TK.js");</script></body></html>