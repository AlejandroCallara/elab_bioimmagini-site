{"version":3,"kind":"Notebook","sha256":"8792a122aac36fc4a8abf50c7097300afce7a910ea2cebca4589bf07f5db4956","slug":"esempio-fcm","location":"/capitolo3/esempio_fcm.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"esempio_fcm.ipynb","url":"/elab_bioimmagini-site//build/esempio_fcm-f8a38807d9df06fda13d75e62f00a16f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom pyclustering.cluster.center_initializer import kmeans_plusplus_initializer\nfrom pyclustering.cluster.fcm import fcm","key":"TeLovZvIHk"},{"type":"outputs","id":"ZmLIfCpobmyJ0-zoMUZUZ","children":[],"key":"IINzCQpeel"}],"key":"EdrSoQn31b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"image = np.zeros((512,512), dtype = np.float32)\nimage[:,:] = 20\nimage[49:99,49:99] = 150\nimage[100:179,100:449] = 300\nimage[199:499,199:349] = 70\nimage[229:269,229:269] = 750\nimage[4:399,449:499] = 550\n\nsigma = 10\n\nimageN = image + sigma*np.random.randn(512, 512)\n\nfig, ax = plt.subplots()\nax.imshow(imageN, cmap = \"gray\")\n\nimageN = imageN.reshape((-1,1))\n# initialize centers\n# initial_centers = kmeans_plusplus_initializer(imageN, 6, kmeans_plusplus_initializer.FARTHEST_CENTER_CANDIDATE).initialize()\ninitial_centers = kmeans_plusplus_initializer(imageN, 6, kmeans_plusplus_initializer.FARTHEST_CENTER_CANDIDATE).initialize()\n\n# create instance of Fuzzy C-Means algotirhm\nfcm_instance = fcm(imageN, initial_centers)\n\n# run cluster analysis and obtain results\nfcm_instance.process()\nclusters = fcm_instance.get_clusters()\ncenters = fcm_instance.get_centers()\n\nmask1 = np.zeros_like(imageN)\nmask1[clusters[0]]=1\nmask1 = mask1.reshape(image.shape)\nmask2 = np.zeros_like(imageN)\nmask2[clusters[1]]=1\nmask2 = mask2.reshape(image.shape)\nmask3 = np.zeros_like(imageN)\nmask3[clusters[2]]=1\nmask3 = mask3.reshape(image.shape)\nmask4 = np.zeros_like(imageN)\nmask4[clusters[3]]=1\nmask4 = mask4.reshape(image.shape)\nmask5 = np.zeros_like(imageN)\nmask5[clusters[4]]=1\nmask5 = mask5.reshape(image.shape)\nmask6 = np.zeros_like(imageN)\nmask6[clusters[5]]=1\nmask6 = mask6.reshape(image.shape)\nfig, ax = plt.subplots(1,6)\nax[0].imshow(mask1)\nax[1].imshow(mask2)\nax[2].imshow(mask3)\nax[3].imshow(mask4)\nax[4].imshow(mask5)\nax[5].imshow(mask6)\nax[0].set_title('fcm - cluster 1')\nax[1].set_title('fcm - cluster 2')\nax[2].set_title('fcm - cluster 3')\nax[3].set_title('fcm - cluster 4')\nax[4].set_title('fcm - cluster 5')\nax[5].set_title('fcm - cluster 6')\nplt.show()\n\n\n\n","key":"ii7jbGLmcc"},{"type":"outputs","id":"HRdZHlvmBOybYMCGJ-2pu","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c695022fcc736db51aabfbfc985fa1","path":"/elab_bioimmagini-site//build/d6c695022fcc736db51aabfbfc985fa1.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"e4ckZ9DxEo"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6154363d3d0e72f5fd695953b43a6ada","path":"/elab_bioimmagini-site//build/6154363d3d0e72f5fd695953b43a6ada.png"},"text/plain":{"content":"<Figure size 640x480 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"cq4f3UDzQT"}],"key":"UtXVRtzk9Y"}],"key":"yWjzRw6KH8"}],"key":"oglc1GB6w9"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esempio Em Gmm","url":"/esempio-em-gmm","group":"Capitolo3"},"next":{"title":"Hierarchical Clustering Example","url":"/hierarchical-clustering-example","group":"Capitolo3"}}},"domain":"http://localhost:3000"}