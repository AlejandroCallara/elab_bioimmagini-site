
# Esempio algoritmo di thinning - Codice 3.10
Nel seguente codice Ã¨ simulato il comportamento di un algoritmo di thinning. 

```python
# -*- coding: utf-8 -*-
"""
Created on Fri Jun  7 16:23:24 2024

@author: alejandro
"""

import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage import binary_hit_or_miss

image = plt.imread('./data/hippo.jpg')
image = (1-image/255)>0.5
image_or= np.copy(image)

plt.figure()
plt.imshow(image, cmap="gray")
plt.show()

# kernels for thinning
k2 = np.array([[0,0,0],[-1,1,-1],[1,1,1]])
print(k2)

k3 = np.array([[-1,0,0],[1,1,0],[-1,1,-1]])
print(k3)

# iterations
n = 100

fig, ax = plt.subplots(1,3)
ax[0].imshow(image, cmap="gray")
ax[0].axis("image")

plt.ion()
plt.show(block=False)
for k in range(0,70):
    # apply kernels
    tmp = binary_hit_or_miss(image, structure1=k2)
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    tmp = binary_hit_or_miss(image, structure1=k3)
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    
    # apply rotated kernels
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k2))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k3))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    
    
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k2,2))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k3,2))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    
    
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k2,3))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    tmp = binary_hit_or_miss(image, structure1=np.rot90(k3,3))
    image = (image.astype(np.float32) - tmp.astype(np.float32)).astype(bool)
    
    ax[1].cla(); ax[1].imshow(image, cmap="gray"); 
    ax[1].axis("image")
    ax[2].cla(); ax[2].imshow(image_or & ~image, cmap="gray"); 
    ax[2].axis("image")

    fig.canvas.draw()
    fig.canvas.flush_events()
    plt.pause(0.1)
plt.show()
```