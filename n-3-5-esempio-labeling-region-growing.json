{"version":3,"kind":"Article","sha256":"853dbfb239e90e570d4c9f2fac0a1f2153dc40d404c5a9ea132b085fc850883b","slug":"n-3-5-esempio-labeling-region-growing","location":"/capitolo3/n_3_5_esempio_labeling_region_growing.md","dependencies":[],"frontmatter":{"title":"Esempio labeling/region growing - Codice 3.5","content_includes_title":false,"numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"n_3_5_esempio_labeling_region_growing.md","url":"/elab_bioimmagini-site/build/n_3_5_esempio_labeli-efc6e87fd3ec894e7830ffc29fa92008.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Nel seguente codice Ã¨ simulato il comportamento degli algoritmi di labeling e region growing.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xV3DbnlQ7n"}],"key":"Bm9IwHXRh1"},{"type":"code","lang":"python","value":"# -*- coding: utf-8 -*-\n\"\"\"\nCreated on Tue May 28 11:42:56 2024\n\n@author: alejandro\n\"\"\"\n\nimport pydicom\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import k_means\nfrom skimage import measure\nfrom skimage.segmentation import flood\n\nds = pydicom.dcmread(\"./data/phantom.dcm\")\nimage = ds.pixel_array\nprint(ds)\n\n# get histogram\np = np.max(image, None)\nprint(p)\ncounts, bins = np.histogram(image, bins = p)\n\n# display phantom image and image histogram\nfig, ax = plt.subplots(1,2)\nax[0].imshow(image, cmap = \"gray\")\nax[1].plot(counts[1:]/np.sum(counts, None))\nplt.show()\n\n# kmeans\nx = image.reshape((-1,1))\ncentroid, label, inertia = k_means(x, n_clusters = 3)\nimage_classes = label.reshape(image.shape)\nidx_c = np.argsort(centroid, axis = 0)\n\n# get water mask\nmask = np.zeros_like(label)\nidx = np.where(label == idx_c[1])\nmask[idx]=255\nmask = np.reshape(mask, image.shape)\n\n# do labeling on water mask\nlabeled_image = measure.label(mask, connectivity=2) \nfig, ax = plt.subplots(1, 3)\nax[0].imshow(image, cmap = 'gray')\nax[1].imshow(mask, cmap = \"gray\")\nax[2].imshow(labeled_image)\nplt.show()\n\n# region growing\nseed = (49, 107)\ntmp = image.copy()\nfig, ax = plt.subplots(1, 4)\nax[0].imshow(image, cmap = \"gray\")\nmask = flood(tmp, seed, tolerance=50)\nax[1].imshow(mask, cmap = \"gray\")\nmask = flood(tmp, seed, tolerance=100)\nax[2].imshow(mask, cmap = \"gray\")\nmask = flood(tmp, seed, tolerance=400)\nax[3].imshow(mask, cmap = \"gray\")\nplt.show()\n\nplt.ion()\nfig, ax = plt.subplots(1, 2)\nnpoints = np.zeros([500])\nx = np.arange(0,500)\nfor T in range(0,500,5):\n    mask = flood(tmp, seed, tolerance = T)\n    ax[0].imshow(mask, cmap = \"gray\")\n    npoints[T] = np.sum(mask, axis = None)\n    ax[1].plot(x, npoints)\n    plt.pause(0.001)\n    plt.gcf().canvas.flush_events()\n    ax[1].clear()\n    \nplt.ioff()\nplt.show()","position":{"start":{"line":4,"column":1},"end":{"line":82,"column":1}},"key":"QTRPkmLke9"}],"key":"zpl89PsLkz"}],"key":"Z0AKQf4IYX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esempio di clustering gerarchico - Notebook 3.4","url":"/n-3-4-hierarchical-clustering-example","group":"Capitolo3"},"next":{"title":"Esempio di segmentazione ai contorni - Notebook 3.6","url":"/n-3-6-seg-contorni","group":"Capitolo3"}}},"domain":"http://localhost:3000"}