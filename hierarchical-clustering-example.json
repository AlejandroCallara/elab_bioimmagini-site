{"version":3,"kind":"Notebook","sha256":"0242cc214339e207e3da48041e91999b16e1d675458c825739edceff433c3184","slug":"hierarchical-clustering-example","location":"/capitolo3/hierarchical_clustering_example.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"hierarchical_clustering_example.ipynb","url":"/elab_bioimmagini-site/build/hierarchical_cluster-3ef4daf80172416fe23a45c4db6aeabd.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial.distance import pdist, squareform\nfrom scipy.cluster.hierarchy import linkage, dendrogram\n","key":"Ffc7Egi9Oh"},{"type":"outputs","id":"jt8CaH-6aH_z1klsKI2TB","children":[],"key":"pwD7BRZcKj"}],"key":"VwmgQ8jyiE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create images with different noise levels\ndim = 256\nimage = np.zeros((dim, dim), dtype =np.float32)\nimage[:,:]=20\nimage[99:199,99:199] = 200\nN = 10\nx = np.zeros((N, dim, dim), dtype = np.float32)\nnoise = np.random.permutation(N)**2\n\nfig, ax = plt.subplots(1, 10)\nfor i in range(N):\n    x[i,:,:] = image + noise[i]*np.random.randn(dim,dim)\n    ax[i].imshow(x[i,:,:], cmap=\"gray\")\n    \nxd = x.reshape(N, dim*dim)\nd = pdist(xd)\nz = squareform(d)\n\n# single linkage\nt = linkage(z, method = \"single\")\nfig, ax = plt.subplots()\ndendrogram(t)\nplt.show()\n\n# average linkage\ntav = linkage(z, method = \"average\")\nfig, ax = plt.subplots()\ndendrogram(tav)\nplt.show()","key":"TXfxQ0U0M8"},{"type":"outputs","id":"sj4fdwgkW5CtTnX0qXUBh","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_25059/119940986.py:20: ClusterWarning: The symmetric non-negative hollow observation matrix looks suspiciously like an uncondensed distance matrix\n  t = linkage(z, method = \"single\")\n"},"children":[],"key":"PHcFPB9ybd"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"57bb4256adb3a1218a85f71b140cfa88","path":"/elab_bioimmagini-site/build/57bb4256adb3a1218a85f71b140cfa88.png"},"text/plain":{"content":"<Figure size 640x480 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"yzNY4v9ws2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a98efb1f786254e4f2c4a9532252bbfc","path":"/elab_bioimmagini-site/build/a98efb1f786254e4f2c4a9532252bbfc.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"YtCttJuvXC"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_25059/119940986.py:26: ClusterWarning: The symmetric non-negative hollow observation matrix looks suspiciously like an uncondensed distance matrix\n  tav = linkage(z, method = \"average\")\n"},"children":[],"key":"WlAZ50LvKW"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f425385b22aa5926969570d64b2bbca","path":"/elab_bioimmagini-site/build/8f425385b22aa5926969570d64b2bbca.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"UZCyv4g7DD"}],"key":"LkCxwpGI3e"}],"key":"Doe350NHvX"}],"key":"APuF0nMTSB"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esempio Fcm","url":"/esempio-fcm","group":"Capitolo3"},"next":{"title":"Mser Example","url":"/mser-example","group":"Capitolo3"}}},"domain":"http://localhost:3000"}