{"version":3,"kind":"Notebook","sha256":"d6d3dd51d66a97310a843e010753038dc2aa322dc0b2db1d8c87f05363d5cd5a","slug":"n-3-2-esempio-fcm","location":"/capitolo3/n_3_2_esempio_fcm.ipynb","dependencies":[],"frontmatter":{"title":"Esempio di segmentazione con FCM - Notebook 3.2","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"n_3_2_esempio_fcm.ipynb","url":"/elab_bioimmagini-site/build/n_3_2_esempio_fcm-39e47dac1f2f721a62f96d8feca9e5a0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import delle librerie necessarie per la simulazione","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DXUL2LPTak"}],"key":"k8XLGbJEXK"}],"key":"GVk35NyEq1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport skfuzzy as fuzz","key":"PcDLPVtHRu"},{"type":"outputs","id":"z3_-t8XkFlURd6oDj4Tuu","children":[],"key":"rdnaxGYrdH"}],"key":"T7MkDg8PC3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Immagine simulata","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mmCsPLrEoc"}],"key":"k9ydolE2SF"}],"key":"DnBE6UjtDA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- synthetic image ---\nimage = np.zeros((512, 512), dtype=np.float32)\nimage[:, :] = 20\nimage[49:99, 49:99] = 150\nimage[100:179, 100:449] = 300\nimage[199:499, 199:349] = 70\nimage[229:269, 229:269] = 750\nimage[4:399, 449:499] = 550\n\nsigma = 10\nrng = np.random.default_rng(0)  # riproducibilit√†\nimageN = image + sigma * rng.standard_normal(image.shape)\n\nfig, ax = plt.subplots(figsize=(5, 5), constrained_layout=True)\nax.imshow(imageN, cmap=\"gray\")\nax.set_title(\"Immagine rumorosa\")\nax.axis(\"off\")\nplt.show()","key":"BsdCMlbZqK"},{"type":"outputs","id":"PtDY7WtMbxC_EwTK7t2gO","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad89530d9d6e776a28bdf2ee420aef82","path":"/elab_bioimmagini-site/build/ad89530d9d6e776a28bdf2ee420aef82.png"},"text/plain":{"content":"<Figure size 500x500 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"gq8pBCbpOw"}],"key":"jfTIznC9cY"}],"key":"YMN7t2wZG2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Segmentazione con ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jFcj3dy84R"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"FCM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UFAu4VP0l8"}],"key":"f2CrwfQhZ9"}],"key":"JzE254hTkB"}],"key":"S2gRY2lLOm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- fuzzy c-means ---\n# cmeans vuole data shape = (features, samples)\nx = imageN.astype(np.float64).ravel()\ndata = x.reshape(1, -1)\n\ncntr, U, _, _, _, _, _ = fuzz.cluster.cmeans(\n    data,\n    c=6,\n    m=2.0,\n    error=1e-5,\n    maxiter=500,\n    init=None\n)\n\n# assegno a ogni pixel il cluster con membership massima (hard label)\nlabels = np.argmax(U, axis=0)  # (N,)\n\n# ordino i cluster per centroide crescente (solo per avere plot ordinati)\norder = np.argsort(cntr.ravel())\nlabels_ord = order[labels]  # rimappa 0..5 secondo l'ordine dei centroidi\n\n# --- masks + plot ---\nmasks = [(labels_ord == k).reshape(image.shape) for k in range(6)]\n\nfig, ax = plt.subplots(1, 6, figsize=(18, 3), constrained_layout=True)\nfor k in range(6):\n    ax[k].imshow(masks[k], cmap=\"gray\")\n    ax[k].set_title(f\"fcm - cluster {k+1}\")\n    ax[k].axis(\"off\")\nplt.show()\n\nprint(\"Centroidi (ordinati):\", np.sort(cntr.ravel()))","key":"cc3SnJDECT"},{"type":"outputs","id":"40iX2G7c8CZtDcCMCIJNe","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02b93cd43a6edb6a1ccc66a6f825429f","path":"/elab_bioimmagini-site/build/02b93cd43a6edb6a1ccc66a6f825429f.png"},"text/plain":{"content":"<Figure size 1800x300 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"chUEu1MO9e"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Centroidi (ordinati): [ 12.42321716  28.73445991  72.93222644 299.72096293 549.97746459\n 750.14344562]\n"},"children":[],"key":"R1WsK9C7Qt"}],"key":"zpT7qHsV8F"}],"key":"nPvWXFoow0"}],"key":"i4MTjHOv3l"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esempio di segmentazione a soglia - Notebook 3.1","url":"/n-3-1-seg-soglia","group":"Capitolo3"},"next":{"title":"Esempio di segmentazione con Gaussian Mixtures - Notebook 3.3","url":"/n-3-3-esempio-em-gmm","group":"Capitolo3"}}},"domain":"http://localhost:3000"}