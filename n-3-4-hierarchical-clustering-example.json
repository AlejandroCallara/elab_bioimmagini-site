{"version":3,"kind":"Notebook","sha256":"187e836710e1109b69acc01bd8a1732f7c7e22998d17d840f3aeb3b7aed17770","slug":"n-3-4-hierarchical-clustering-example","location":"/capitolo3/n_3_4_hierarchical_clustering_example.ipynb","dependencies":[],"frontmatter":{"title":"Esempio di clustering gerarchico - Notebook 3.4","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv (3.12.9)","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"n_3_4_hierarchical_clustering_example.ipynb","url":"/elab_bioimmagini-site/build/n_3_4_hierarchical_c-24f45e45a8afd3f8a55dcd8b6615e23c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import delle librerie necessarie per la simulazione","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k2gGbrVmQG"}],"key":"cFKHUx2QvH"}],"key":"sLSPKVRUU2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial.distance import pdist, squareform\nfrom scipy.cluster.hierarchy import linkage, dendrogram","key":"bExda6Wu9w"},{"type":"outputs","id":"n_36-OKNR17iG9Yj3RdfE","children":[],"key":"cjU1wmNYKR"}],"key":"GRRhvUDv4m"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Segmentazione tramite hierarchical clustering","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8ClhtFip2"}],"key":"DHqWEXgpN7"}],"key":"hyqZMEIYri"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create images with different noise levels\ndim = 256\nimage = np.zeros((dim, dim), dtype =np.float32)\nimage[:,:]=20\nimage[99:199,99:199] = 200\nN = 10\nx = np.zeros((N, dim, dim), dtype = np.float32)\nnoise = np.random.permutation(N)**2\n\nfig, ax = plt.subplots(1, 10)\nfor i in range(N):\n    x[i,:,:] = image + noise[i]*np.random.randn(dim,dim)\n    ax[i].imshow(x[i,:,:], cmap=\"gray\")\n    \nxd = x.reshape(N, dim*dim)\nd = pdist(xd)\nz = squareform(d)\n\n# single linkage\nt = linkage(z, method = \"single\")\nfig, ax = plt.subplots()\ndendrogram(t)\nplt.show()\n\n# average linkage\ntav = linkage(z, method = \"average\")\nfig, ax = plt.subplots()\ndendrogram(tav)\nplt.show()","key":"BKrKHx1QtF"},{"type":"outputs","id":"9tqMAFWBMBIj0gbGJLJwZ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_11022/119940986.py:20: ClusterWarning: The symmetric non-negative hollow observation matrix looks suspiciously like an uncondensed distance matrix\n  t = linkage(z, method = \"single\")\n"},"children":[],"key":"bkDoYcNOOo"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8182fb3b913ad98e4e89ae65b6b03e2a","path":"/elab_bioimmagini-site/build/8182fb3b913ad98e4e89ae65b6b03e2a.png"},"text/plain":{"content":"<Figure size 640x480 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"y33JjEf555"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"89b9693d03883efb085ede855ee85b40","path":"/elab_bioimmagini-site/build/89b9693d03883efb085ede855ee85b40.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"B7MLske9sQ"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/var/folders/f2/szdn4h555wv3xkj5npgb1nqc0000gn/T/ipykernel_11022/119940986.py:26: ClusterWarning: The symmetric non-negative hollow observation matrix looks suspiciously like an uncondensed distance matrix\n  tav = linkage(z, method = \"average\")\n"},"children":[],"key":"eEHf6EkmbP"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"26799f12a3825e78a52f01404f183827","path":"/elab_bioimmagini-site/build/26799f12a3825e78a52f01404f183827.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"p0m4QsAOCT"}],"key":"naG1uaOMVh"}],"key":"OsxCu1qki6"}],"key":"Wp9ZMdQqyO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Esempio di segmentazione con Gaussian Mixtures - Notebook 3.3","url":"/n-3-3-esempio-em-gmm","group":"Capitolo3"},"next":{"title":"Esempio labeling/region growing - Codice 3.5","url":"/n-3-5-esempio-labeling-region-growing","group":"Capitolo3"}}},"domain":"http://localhost:3000"}